# SectionBoxRevitPlugin
## Основные технологии
1. .NET Framework 4.8
2. LINQ
3. Revit API 2020
4. WPF
5. WinForms

## Назначение и логика работы
Плагин предназначен для обрезки 3D вида по элементам из связанной модели, выбор которых происходит при запуске плагина. После в диалоговом окне необходимо выбрать целевой 3D вид, либо создать новый.
  
## Установка и запуск
Скопировать содержимое папки "_prod_" в данном репозитории в папку с плагинами для подгрузки их в Revit: **C:\Users\%username%\AppData\Roaming\Autodesk\Revit\Addins\2020**
При запуске Revit в появившемся окне выбрать "Всегда загружать" или "Загрузить один раз".

![Загрузка в Revit](https://github.com/ipbtech/SectionBoxRevitPlugin/blob/6a876bd6812ef9eadeb5e26befe73a79d68ff687/raw/1.png)

Установленная команда появится на ленте "Надстройки", после запуска которой в пространстве модели можно выбрать целевые элементы (из связанных моделей) и нажать "Готово" в строке под панелью инструментов.

![Команда на ленте](https://github.com/ipbtech/SectionBoxRevitPlugin/blob/97577c02237e12cae2b2ce6ad38beb2a0c6c81c9/raw/2.png)
![Выборка элементов в Revit](https://github.com/ipbtech/SectionBoxRevitPlugin/blob/97577c02237e12cae2b2ce6ad38beb2a0c6c81c9/raw/3.png)

## Интерфейс

![Интерфейс](https://github.com/ipbtech/SectionBoxRevitPlugin/blob/ea707ff29253378c9c016f882adfcc728349a189/raw/4.png)

После выбора элементов появится диалоговое окно, в котором есть следующие элементы:
1. Выпадающий список для выбора 3D вида для осуществления обрезки по выбранным при старте команды элементам. По умолчанию стоит выбор на текущем активном виде. Данный вариант доступен только если активным видом в модели является 3D вид, и __если на данном виде отображаются целевые модели__. В случае если это не так, то при попытке запуска будет выдано предупреждение, после закрытия которого нужно указать корректный вид из выпадающего списка или создать новый.
![](https://github.com/ipbtech/SectionBoxRevitPlugin/blob/8547d4d2a1f295837b3727261c064ff0b7e96de3/raw/5.png)
2. Checkbox (галка) для создания нового 3D вида, на котором будет осуществлена обрезка вида. Вид создается с именем в формате "SectionBoxView.SpecialId({id вида})", где id - рандомное четырехзначное число.
3. Кнопка запуска программа. После чего диалоговое окно плагина будет закрыто, а активным видом в модели станет выбранный 3D вид.

