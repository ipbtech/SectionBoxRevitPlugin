# SectionBoxRevitPlugin
## Основные технологии
1. .NET Framework 4.8
2. LINQ
3. Revit API 2020
4. WPF
5. WinForms

## Назначение и логика работы
Плагин предназначен для обрезки 3D вида по элементам из связанной модели, выбор которых происходит при запуске плагина. После в диалоговом окне необходимо выбрать целевой 3D вид, либо создать новый.
  
## Установка и запуск
Скопировать содержимое папки "_prod_" в данном репозитории в папку с плагинами для подгрузки их в Revit: **C:\Users\%username%\AppData\Roaming\Autodesk\Revit\Addins\2020**
При запуске Revit в появившемся окне выбрать "Всегда загружать" или "Загрузить один раз".

![Загрузка в Revit](https://github.com/ipbtech/SectionBoxRevitPlugin/blob/6a876bd6812ef9eadeb5e26befe73a79d68ff687/raw/1.png)

Установленная команда появится на ленте "Надстройки", после запуска которой в пространстве модели можно выбрать целевые элементы (из связанных моделей) и нажать "Готово" в строке под панелью инструментов.
![Команда на ленте](https://github.com/ipbtech/SectionBoxRevitPlugin/blob/97577c02237e12cae2b2ce6ad38beb2a0c6c81c9/raw/2.png)
![Выборка элементов в Revit](https://github.com/ipbtech/SectionBoxRevitPlugin/blob/97577c02237e12cae2b2ce6ad38beb2a0c6c81c9/raw/3.png)

## Интерфейс
![Интерфейс](https://github.com/ipbtech/CopyRevitSchedules_Test/blob/21874c130688f37e293f69238a180fbebc4231c6/Raw/2.png)

После 
1. Выбор
2. Вспомогательное окно, в котором отображаются имена моделей для обрбаботки после загрузки .txt файла
3. Выборка спецификаций АР из текущего проекта (при отжатии галочки выборка очищается)
4. Выборка спецификаций КР из текущего проекта (при отжатии галочки выборка очищается)
5. Кнопка запуска программы

## Требования для корреткной работы
Для запуска плагина на вход должен быть подан .txt файл со списком путей к обрабатываемым моделям, а также выбраны либо спецификации АР, либо спецификации КР (либо и то, и то). При попытке холостого запуска будет показано уведомляющее окно. Если при нажатии галочки Копирование спецификаций АР/Копирование спецификаций КР, данные спецификации не найдены в проекте будет также показано уведомляющее окно.
